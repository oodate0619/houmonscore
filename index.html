<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Demo3｜訪問計画の経営インパクト可視化（静的デモ）</title>
  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --text:#172033;
      --muted:#5b677a;
      --line:rgba(17,32,51,.10);
      --accent:#2f6fed;
      --accent2:#16a34a;
      --warn:#b45309;
      --shadow: 0 12px 30px rgba(17,32,51,.10);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Sans", "Helvetica Neue", Arial;
      background: radial-gradient(900px 520px at 10% 0%, rgba(47,111,237,.10), transparent 55%),
                  radial-gradient(900px 520px at 85% 10%, rgba(22,163,74,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    .wrap{max-width:1120px; margin:0 auto; padding:22px 16px 44px;}
    .top{
      display:flex; justify-content:space-between; gap:14px; flex-wrap:wrap;
      align-items:flex-start;
      margin-bottom:14px;
    }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border:1px solid var(--line);
      border-radius:999px; background: rgba(255,255,255,.75);
      color:var(--muted); font-size:12px;
    }
    h1{margin:8px 0 6px; font-size:20px; letter-spacing:.2px;}
    .sub{margin:0; color:var(--muted); font-size:13px; max-width:860px;}
    .grid{display:grid; grid-template-columns: 420px 1fr; gap:14px; margin-top:14px;}
    @media (max-width:980px){ .grid{grid-template-columns:1fr;} }

    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .hd{
      padding:14px 14px 12px;
      border-bottom:1px solid var(--line);
      display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;
    }
    .hd h2{margin:0; font-size:14px;}
    .bd{padding:14px;}
    .muted{color:var(--muted)}
    .small{font-size:12px}

    /* Hero */
    .hero{
      border: 1px solid var(--line);
      border-radius: var(--radius);
      padding:14px;
      background: linear-gradient(135deg, rgba(47,111,237,.08), rgba(22,163,74,.08));
    }
    .heroTitle{margin:0; font-size:13px; color:var(--muted);}
    .heroBig{
      margin:8px 0 6px;
      font-size:28px;
      font-weight:900;
      letter-spacing:.3px;
    }
    .heroSub{margin:0; color:var(--muted); font-size:12px;}
    .pills{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px;}
    .pill{
      border:1px solid var(--line);
      background: rgba(255,255,255,.8);
      border-radius: 999px;
      padding:8px 10px;
      font-size:12px;
      color:var(--muted);
      display:inline-flex; gap:8px; align-items:center;
    }
    .pill b{color:var(--text)}
    .ctaRow{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px;}
    button{
      padding:10px 12px;
      border-radius: 12px;
      border:1px solid var(--line);
      background:#fff;
      color:var(--text);
      cursor:pointer;
      font-size:12px;
    }
    button:hover{background: rgba(47,111,237,.06); border-color: rgba(47,111,237,.25);}
    .btnPrimary{
      border-color: rgba(47,111,237,.35);
      background: rgba(47,111,237,.10);
    }

    /* Inputs */
    .presetRow{display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px;}
    .field{
      display:grid;
      grid-template-columns: 1fr 140px;
      gap:10px;
      align-items:center;
      padding:10px 0;
      border-bottom:1px dashed rgba(17,32,51,.12);
    }
    .field:last-child{border-bottom:none}
    label{font-size:13px; font-weight:700;}
    .hint{margin-top:3px; color:var(--muted); font-size:12px;}
    input[type="number"]{
      width:100%;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#fff;
      color:var(--text);
      outline:none;
    }
    input[type="range"]{width:100%; accent-color: var(--accent);}
    .rangeBox{display:flex; flex-direction:column; gap:6px;}
    .rangeLabel{font-size:12px; color:var(--muted);}

    details{
      margin-top:12px;
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(255,255,255,.85);
      padding:10px 12px;
    }
    summary{cursor:pointer; font-size:13px; font-weight:800;}
    .note{
      margin-top:12px;
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:12px;
      background: rgba(255,255,255,.85);
      color:var(--muted);
      font-size:12px;
    }

    /* Breakdown */
    .split{display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:12px;}
    @media (max-width:720px){ .split{grid-template-columns:1fr;} }

    .callout{
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:12px;
      background: rgba(255,255,255,.9);
    }
    .callout b{color:var(--text)}
    .callout .title{font-weight:900; font-size:13px; margin-bottom:6px;}
    .callout.good{border-color: rgba(22,163,74,.28); background: rgba(22,163,74,.06);}
    .callout.warn{border-color: rgba(180,83,9,.28); background: rgba(180,83,9,.06);}

    .statGrid{display:grid; grid-template-columns: repeat(2, 1fr); gap:10px; margin-top:12px;}
    @media (max-width:720px){ .statGrid{grid-template-columns:1fr;} }
    .stat{
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:12px;
      background:#fff;
    }
    .stat .k{color:var(--muted); font-size:12px;}
    .stat .v{margin-top:6px; font-size:18px; font-weight:900;}
    .stat .s{margin-top:6px; color:var(--muted); font-size:12px;}

    .barWrap{
      margin-top:12px;
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding:12px;
      background:#fff;
    }
    .bar{
      height:12px;
      border-radius:999px;
      background: rgba(17,32,51,.08);
      overflow:hidden;
      margin-top:10px;
    }
    .bar > div{
      height:100%;
      width:50%;
      background: linear-gradient(90deg, rgba(47,111,237,.85), rgba(22,163,74,.80));
    }
    .barMeta{
      display:flex; justify-content:space-between; gap:10px;
      margin-top:10px; color:var(--muted); font-size:12px; flex-wrap:wrap;
    }
    .footer{
      margin-top:14px;
      padding-top:10px;
      border-top:1px solid var(--line);
      color:var(--muted);
      font-size:12px;
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div>
        <div class="chip">Demo3｜経営インパクト可視化（静的HTML / 実データ不要）</div>
        <h1>訪問計画の価値を、<span style="color:var(--accent); font-weight:900;">「年間削減」</span>で一撃表示</h1>
        <p class="sub">
          このデモは「正確な見積」ではなく、意思決定のための“腹落ち”を作るものです。<br>
          まずは <b>最小入力</b> だけで結果を出し、必要なら詳細を開いて調整できます。
        </p>
      </div>
      <div class="chip">GitHub Pages直置き / サーバー不要 / APIキー不要</div>
    </div>

    <div class="grid">
      <!-- LEFT -->
      <section class="card">
        <div class="hd">
          <h2>① 前提（最小入力でOK）</h2>
          <span class="muted small">抵抗がある人でも触れる設計</span>
        </div>
        <div class="bd">
          <div class="presetRow">
            <button type="button" data-preset="small">小規模（5名）</button>
            <button type="button" data-preset="mid" class="btnPrimary">中規模（20名）</button>
            <button type="button" data-preset="large">大規模（50名）</button>
            <button type="button" id="resetBtn">リセット</button>
          </div>

          <!-- Minimal inputs -->
          <div class="field">
            <div>
              <label>稼働人数（技術者）</label>
              <div class="hint">訪問に出る人数（管理のみは除外）。</div>
            </div>
            <input id="tech" type="number" min="1" step="1" value="20" />
          </div>

          <div class="field">
            <div>
              <label>1人あたり訪問件数 / 日</label>
              <div class="hint">平均でOK（繁忙期は後で調整）。</div>
            </div>
            <input id="visitsPerDay" type="number" min="1" step="1" value="6" />
          </div>

          <div class="field">
            <div>
              <label>人件費（概算）/ 時間</label>
              <div class="hint">残業単価でも、実効コストでもOK。</div>
            </div>
            <input id="costPerHour" type="number" min="500" step="50" value="2500" />
          </div>

          <details>
            <summary>詳細設定（必要な場合だけ開く）</summary>

            <div class="field" style="margin-top:6px;">
              <div>
                <label>稼働日数 / 月</label>
                <div class="hint">例：20日（平日稼働）。</div>
              </div>
              <input id="workDays" type="number" min="1" step="1" value="20" />
            </div>

            <div class="field">
              <div>
                <label>計画・調整に使う時間（全体）/ 日</label>
                <div class="hint">朝の割当、差し込み、電話調整など。</div>
              </div>
              <input id="planMinDay" type="number" min="0" step="5" value="90" />
            </div>

            <div class="field">
              <div>
                <label>事務（報告・記録）時間 / 訪問</label>
                <div class="hint">報告書、社内共有、写真整理など。</div>
              </div>
              <input id="adminMinVisit" type="number" min="0" step="1" value="8" />
            </div>

            <div class="field">
              <div>
                <label>手戻り（再訪/確認）率</label>
                <div class="hint">情報不足・抜け漏れで増える部分。</div>
              </div>
              <div class="rangeBox">
                <input id="reworkRate" type="range" min="0" max="20" step="1" value="6" />
                <div class="rangeLabel"><span id="reworkRateLabel">6</span>%</div>
              </div>
            </div>

            <div class="field">
              <div>
                <label>手戻り1件あたりの時間（保守的な仮定）</label>
                <div class="hint">「調整＋報告＋連絡」を控えめに見積もるための値。</div>
              </div>
              <div class="rangeBox">
                <input id="reworkProxyMin" type="range" min="5" max="60" step="5" value="20" />
                <div class="rangeLabel"><span id="reworkProxyMinLabel">20</span>分 / 件</div>
              </div>
            </div>

            <div class="field">
              <div>
                <label>標準化/AIで減る割合（計画時間）</label>
                <div class="hint">テンプレ化・要点抽出・判断基準の統一の効果。</div>
              </div>
              <div class="rangeBox">
                <input id="planReduce" type="range" min="10" max="70" step="5" value="40" />
                <div class="rangeLabel"><span id="planReduceLabel">40</span>%削減</div>
              </div>
            </div>

            <div class="field">
              <div>
                <label>標準化/AIで減る分（事務/訪問）</label>
                <div class="hint">報告テンプレ、文章の自動整形、定型文。</div>
              </div>
              <div class="rangeBox">
                <input id="adminReduceMin" type="range" min="0" max="6" step="1" value="3" />
                <div class="rangeLabel">-<span id="adminReduceMinLabel">3</span>分</div>
              </div>
            </div>

            <div class="field">
              <div>
                <label>標準化/AIで減る割合（手戻り）</label>
                <div class="hint">チェックリスト運用・抜け漏れ予防。</div>
              </div>
              <div class="rangeBox">
                <input id="reworkReduce" type="range" min="0" max="70" step="5" value="35" />
                <div class="rangeLabel"><span id="reworkReduceLabel">35</span>%低減</div>
              </div>
            </div>
          </details>

          <details>
            <summary>（安全設計）デモで扱わない情報</summary>
            <div class="note" style="margin-top:10px;">
              このデモは <b>実データ入力なし</b> で成立します。<br>
              顧客名・住所・連絡先・契約内容・個別の売上/粗利・機密の保守条件などは扱いません。<br>
              実連携は「次のステップ」でCSV/台帳（必要ならマスキング）を使う前提に留めます。
            </div>
          </details>

          <div class="note">
            ✅ まずは「最小入力」で結果を出す → その場で腹落ち<br>
            ✅ 突っ込まれたら「詳細設定」で前提を調整<br>
            ✅ そのうえで次回、実データ連携（匂わせ）へ
          </div>
        </div>
      </section>

      <!-- RIGHT -->
      <section class="card">
        <div class="hd">
          <h2>② 1秒で伝える結論</h2>
          <span class="muted small">年間削減（時間 / 円）</span>
        </div>
        <div class="bd">
          <div class="hero">
            <p class="heroTitle">結論（この画面で伝えたいこと）</p>
            <div class="heroBig" id="heroText">年間 0時間 / 0円 削減</div>
            <p class="heroSub" id="heroSub">（前提：20名 / 6件/日 / 20日/月）</p>

            <div class="pills">
              <div class="pill">月間削減 <b id="saveHoursMonth">0</b> 時間</div>
              <div class="pill">年間削減 <b id="saveHoursYear">0</b> 時間</div>
              <div class="pill">年間削減 <b id="saveCostYear">0</b> 円</div>
              <div class="pill">手戻り低減 <b id="reworkDelta">0</b> 件/月</div>
            </div>

            <div class="ctaRow">
              <button type="button" id="copyBtn" class="btnPrimary">前提と結論をコピー（稟議・社内共有用）</button>
              <button type="button" id="toggleExplainBtn">内訳まで見る</button>
            </div>
          </div>

          <div class="split">
            <div class="callout good">
              <div class="title">このデモが言いたいこと</div>
              「訪問順の精密最適化」の前に、<br>
              <b>計画・報告・手戻り</b>を標準化して <b>毎月のムダ</b>を削る。
            </div>
            <div class="callout warn">
              <div class="title">やらないこと（機能追加ゲーム防止）</div>
              ルート精密計算／実データ連携／内輪メモ表示はしません。<br>
              目的は“腹落ち”です。
            </div>
          </div>

          <div id="explainArea" style="margin-top:12px;">
            <div class="hd" style="padding:0; border:0; margin-top:6px;">
              <h2 style="margin:0; font-size:14px;">③ 何が減るのか（内訳）</h2>
              <span class="muted small">疑いを潰す</span>
            </div>

            <div class="statGrid">
              <div class="stat">
                <div class="k">計画・調整（全体）</div>
                <div class="v" id="breakPlan">0 時間/月</div>
                <div class="s" id="breakPlanS">（90分/日 → 54分/日）</div>
              </div>
              <div class="stat">
                <div class="k">事務（報告・記録）</div>
                <div class="v" id="breakAdmin">0 時間/月</div>
                <div class="s" id="breakAdminS">（8分/訪問 → 5分/訪問）</div>
              </div>
              <div class="stat">
                <div class="k">手戻り（再訪・確認）</div>
                <div class="v" id="breakRework">0 時間/月</div>
                <div class="s" id="breakReworkS">（6% → 3.9%）</div>
              </div>
              <div class="stat">
                <div class="k">合計</div>
                <div class="v" id="breakTotal">0 時間/月</div>
                <div class="s" id="breakTotalS">＝年間換算と金額に変換</div>
              </div>
            </div>

            <div class="barWrap">
              <div class="muted small">改善の腹落ち（イメージ）</div>
              <div class="bar"><div id="barFill" style="width:50%"></div></div>
              <div class="barMeta">
                <span>現状ムダ（推定）</span>
                <span><b id="barPct" style="color:var(--text);">50</b>% 改善</span>
                <span>標準化＋AIで縮む</span>
              </div>
            </div>

            <details>
              <summary>次のステップ（実連携は“匂わせ”まで）</summary>
              <div class="note" style="margin-top:10px;">
                ✅ 現場台帳（CSV）→ 計画・報告テンプレへ自動投入（必要ならマスキング）<br>
                ✅ チェックリスト運用で抜け漏れを減らし、手戻りを低減<br>
                ✅ 90日で「新人でも回る」運用ルール化（定着）<br>
                ※このデモではAPI/サーバー連携はしません（安心を優先）。
              </div>
            </details>

            <div class="footer">
              「削減額」だけではなく、<b>何が減るか（内訳）</b>を見せると納得が上がります。<br>
              さらに刺させるなら、空いた時間の使い道（教育・顧客フォロー・緊急対応吸収）を提案資料で一言。
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

<script>
  const el = (id)=>document.getElementById(id);
  const clamp = (n, min, max)=> Math.max(min, Math.min(max, n));
  const fmtInt = (n)=> Math.round(n).toLocaleString('ja-JP');

  const state = {
    tech: 20,
    visitsPerDay: 6,
    workDays: 20,
    planMinDay: 90,
    adminMinVisit: 8,
    reworkRate: 6,          // %
    costPerHour: 2500,
    planReduce: 40,         // %
    adminReduceMin: 3,      // minutes
    reworkReduce: 35,       // %
    reworkProxyMin: 20      // minutes per rework case
  };

  function readInputs(){
    state.tech = clamp(Number(el('tech').value || 1), 1, 9999);
    state.visitsPerDay = clamp(Number(el('visitsPerDay').value || 1), 1, 200);
    state.costPerHour = clamp(Number(el('costPerHour').value || 0), 500, 20000);

    // detail inputs may not exist yet? they do, but keep safe:
    state.workDays = el('workDays') ? clamp(Number(el('workDays').value || 1), 1, 31) : 20;
    state.planMinDay = el('planMinDay') ? clamp(Number(el('planMinDay').value || 0), 0, 600) : 90;
    state.adminMinVisit = el('adminMinVisit') ? clamp(Number(el('adminMinVisit').value || 0), 0, 120) : 8;

    state.reworkRate = el('reworkRate') ? clamp(Number(el('reworkRate').value || 0), 0, 50) : 6;
    state.planReduce = el('planReduce') ? clamp(Number(el('planReduce').value || 0), 10, 80) : 40;
    state.adminReduceMin = el('adminReduceMin') ? clamp(Number(el('adminReduceMin').value || 0), 0, 15) : 3;
    state.reworkReduce = el('reworkReduce') ? clamp(Number(el('reworkReduce').value || 0), 0, 90) : 35;
    state.reworkProxyMin = el('reworkProxyMin') ? clamp(Number(el('reworkProxyMin').value || 20), 5, 120) : 20;

    // labels
    if(el('reworkRateLabel')) el('reworkRateLabel').textContent = state.reworkRate;
    if(el('planReduceLabel')) el('planReduceLabel').textContent = state.planReduce;
    if(el('adminReduceMinLabel')) el('adminReduceMinLabel').textContent = state.adminReduceMin;
    if(el('reworkReduceLabel')) el('reworkReduceLabel').textContent = state.reworkReduce;
    if(el('reworkProxyMinLabel')) el('reworkProxyMinLabel').textContent = state.reworkProxyMin;
  }

  function compute(){
    const totalVisitsPerMonth = state.tech * state.visitsPerDay * state.workDays;

    // PLAN (team-level)
    const planBaseMinMonth = state.planMinDay * state.workDays;
    const planAfterMinMonth = planBaseMinMonth * (1 - state.planReduce/100);
    const planSaveMinMonth = planBaseMinMonth - planAfterMinMonth;

    // ADMIN (per visit)
    const adminAfterMinVisit = clamp(state.adminMinVisit - state.adminReduceMin, 0, 999);
    const adminBaseMinMonth = state.adminMinVisit * totalVisitsPerMonth;
    const adminAfterMinMonth = adminAfterMinVisit * totalVisitsPerMonth;
    const adminSaveMinMonth = adminBaseMinMonth - adminAfterMinMonth;

    // REWORK (rate reduced) -> time by proxy minutes
    const reworkBaseVisits = totalVisitsPerMonth * (state.reworkRate/100);
    const reworkAfterVisits = reworkBaseVisits * (1 - state.reworkReduce/100);
    const reworkDeltaVisits = reworkBaseVisits - reworkAfterVisits;
    const reworkSaveMinMonth = reworkDeltaVisits * state.reworkProxyMin;

    // totals
    const saveMinMonth = planSaveMinMonth + adminSaveMinMonth + reworkSaveMinMonth;
    const saveHoursMonth = saveMinMonth / 60;
    const saveHoursYear = saveHoursMonth * 12;
    const saveCostYear = saveHoursYear * state.costPerHour;

    // breakdown hours/month
    const planSaveH = planSaveMinMonth/60;
    const adminSaveH = adminSaveMinMonth/60;
    const reworkSaveH = reworkSaveMinMonth/60;

    // hero
    el('saveHoursMonth').textContent = fmtInt(saveHoursMonth);
    el('saveHoursYear').textContent = fmtInt(saveHoursYear);
    el('saveCostYear').textContent = fmtInt(saveCostYear);
    el('reworkDelta').textContent = fmtInt(reworkDeltaVisits);

    el('heroText').textContent = `年間 ${fmtInt(saveHoursYear)}時間 / ${fmtInt(saveCostYear)}円 削減`;
    el('heroSub').textContent = `（前提：${state.tech}名 / ${state.visitsPerDay}件/日 / ${state.workDays}日/月）`;

    // breakdown
    const planAfterPerDay = state.planMinDay * (1 - state.planReduce/100);
    el('breakPlan').textContent = `${fmtInt(planSaveH)} 時間/月`;
    el('breakPlanS').textContent = `（${state.planMinDay}分/日 → ${Math.round(planAfterPerDay)}分/日）`;

    el('breakAdmin').textContent = `${fmtInt(adminSaveH)} 時間/月`;
    el('breakAdminS').textContent = `（${state.adminMinVisit}分/訪問 → ${adminAfterMinVisit}分/訪問）`;

    const reworkAfterRate = state.reworkRate * (1 - state.reworkReduce/100);
    el('breakRework').textContent = `${fmtInt(reworkSaveH)} 時間/月`;
    el('breakReworkS').textContent = `（${state.reworkRate}% → ${reworkAfterRate.toFixed(1)}% ／ 1件=${state.reworkProxyMin}分換算）`;

    el('breakTotal').textContent = `${fmtInt(saveHoursMonth)} 時間/月`;
    el('breakTotalS').textContent = `＝年間 ${fmtInt(saveHoursYear)}時間（×${fmtInt(state.costPerHour)}円/時 → ${fmtInt(saveCostYear)}円）`;

    // bar score
    const adminPct = state.adminMinVisit > 0 ? (state.adminReduceMin / state.adminMinVisit) * 100 : 0;
    const score = clamp((state.planReduce*0.45 + adminPct*0.35 + state.reworkReduce*0.20), 10, 80);
    el('barFill').style.width = `${score}%`;
    el('barPct').textContent = Math.round(score);

    return {
      totalVisitsPerMonth,
      planSaveH, adminSaveH, reworkSaveH,
      saveHoursMonth, saveHoursYear, saveCostYear,
      reworkDeltaVisits,
      adminAfterMinVisit,
      planAfterPerDay,
      reworkAfterRate
    };
  }

  function render(){
    readInputs();
    compute();
  }

  function applyPreset(name){
    const is = (id)=>el(id);
    if(name === 'small'){
      is('tech').value = 5;
      is('visitsPerDay').value = 5;
      is('costPerHour').value = 2300;

      is('workDays').value = 20;
      is('planMinDay').value = 60;
      is('adminMinVisit').value = 9;
      is('reworkRate').value = 7;
      is('reworkProxyMin').value = 20;
      is('planReduce').value = 35;
      is('adminReduceMin').value = 3;
      is('reworkReduce').value = 30;
    }
    if(name === 'mid'){
      is('tech').value = 20;
      is('visitsPerDay').value = 6;
      is('costPerHour').value = 2500;

      is('workDays').value = 20;
      is('planMinDay').value = 90;
      is('adminMinVisit').value = 8;
      is('reworkRate').value = 6;
      is('reworkProxyMin').value = 20;
      is('planReduce').value = 40;
      is('adminReduceMin').value = 3;
      is('reworkReduce').value = 35;
    }
    if(name === 'large'){
      is('tech').value = 50;
      is('visitsPerDay').value = 6;
      is('costPerHour').value = 2800;

      is('workDays').value = 22;
      is('planMinDay').value = 140;
      is('adminMinVisit').value = 7;
      is('reworkRate').value = 5;
      is('reworkProxyMin').value = 20;
      is('planReduce').value = 45;
      is('adminReduceMin').value = 3;
      is('reworkReduce').value = 40;
    }

    // highlight preset button style
    document.querySelectorAll('button[data-preset]').forEach(b=>b.classList.remove('btnPrimary'));
    const btn = document.querySelector(`button[data-preset="${name}"]`);
    if(btn) btn.classList.add('btnPrimary');

    render();
  }

  function bind(){
    // minimal
    ['tech','visitsPerDay','costPerHour'].forEach(id=>{
      el(id).addEventListener('input', render);
    });

    // details
    ['workDays','planMinDay','adminMinVisit'].forEach(id=>{
      el(id).addEventListener('input', render);
    });
    ['reworkRate','reworkProxyMin','planReduce','adminReduceMin','reworkReduce'].forEach(id=>{
      el(id).addEventListener('input', render);
    });

    document.querySelectorAll('button[data-preset]').forEach(btn=>{
      btn.addEventListener('click', ()=> applyPreset(btn.dataset.preset));
    });

    el('resetBtn').addEventListener('click', ()=> applyPreset('mid'));

    // copy
    el('copyBtn').addEventListener('click', ()=>{
      readInputs();
      const r = compute();
      const text =
`【Demo3：訪問計画の経営インパクト（腹落ち用）】
結論：年間 ${fmtInt(r.saveHoursYear)}時間 / ${fmtInt(r.saveCostYear)}円 削減（推定）

前提（デモ用・実データ不使用）：
- 稼働人数：${state.tech}名
- 訪問件数：${state.visitsPerDay}件/日
- 稼働日数：${state.workDays}日/月
- 人件費：${fmtInt(state.costPerHour)}円/時

内訳（何が減るか）：
- 計画・調整：${fmtInt(r.planSaveH)}時間/月（${state.planMinDay}分/日 → ${Math.round(r.planAfterPerDay)}分/日）
- 事務（報告・記録）：${fmtInt(r.adminSaveH)}時間/月（${state.adminMinVisit}分/訪問 → ${r.adminAfterMinVisit}分/訪問）
- 手戻り（再訪/確認）：${fmtInt(r.reworkSaveH)}時間/月（${state.reworkRate}% → ${r.reworkAfterRate.toFixed(1)}%）
  ※手戻り1件=${state.reworkProxyMin}分で控えめに換算

注意：これは精密見積ではなく意思決定用の腹落ちデモです。`;
      navigator.clipboard?.writeText(text).then(()=>{
        el('copyBtn').textContent = 'コピーしました';
        setTimeout(()=> el('copyBtn').textContent = '前提と結論をコピー（稟議・社内共有用）', 1200);
      }).catch(()=>{
        // fallback
        prompt('コピーできない場合は、ここから手動でコピーしてください。', text);
      });
    });

    // explain toggle
    const explainArea = el('explainArea');
    const btn = el('toggleExplainBtn');
    let open = true;
    const setOpen = (v)=>{
      open = v;
      explainArea.style.display = open ? 'block' : 'none';
      btn.textContent = open ? '内訳を閉じる' : '内訳まで見る';
    };
    btn.addEventListener('click', ()=> setOpen(!open));
    setOpen(true);
  }

  // init
  bind();
  applyPreset('mid');
</script>
</body>
</html>
